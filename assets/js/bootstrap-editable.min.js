/*! Bootstrap Editable - v1.1.4 
* In-place editing with Bootstrap Form and Popover
* https://github.com/vitalets/bootstrap-editable
* Copyright (c) 2012 Vitaliy Potapov; Licensed MIT, GPL */(function(e){function n(e){return this.each(function(t,n){if(n.setSelectionRange)n.setSelectionRange(e,e);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),r.moveEnd("character",e),r.moveStart("character",e),r.select()}}),this}function r(e,t){if(typeof e=="string"&&e.length&&e.match(/^\{.*\}$/))if(t)try{e=(new Function("return "+e))()}catch(n){}finally{return e}else e=(new Function("return "+e))();return e}function i(t,n,r){var i,s;if(!e.isArray(r))return t;for(var o=0;o<r.length;o++){i=r[o];if(i in n){t[i]=n[i];continue}s=i.toLowerCase(),s in n&&(t[i]=n[s])}return t}var t=function(t,n){function a(){this.handleEmpty(),this.$element.trigger("init",this);var e=jQuery.Event("render");e.isInit=!0,this.$element.trigger(e,this)}var i,s,o=!1,u=!1;this.$element=e(t),n&&n.placement&&!this.$element.data("placement")&&this.$element.attr("data-placement",n.placement),n&&n.title&&!this.$element.data("original-title")&&this.$element.attr("data-original-title",n.title),i=this.$element.data().type||n&&n.type||e.fn.editable.defaults.type,this.settings=e.extend({},e.fn.editable.defaults,e.fn.editable.types.defaults,n,this.$element.data(),{type:i,field:e.extend(!0,{},e.fn.editable.fieldTypes[i])}),this.settings.field.init.call(this,n),this.name=this.settings.name||this.$element.attr("id"),this.name||e.error("You should define name (or id) for Editable element"),typeof this.settings.validate=="object"&&this.name in this.settings.validate&&(this.settings.validate=this.settings.validate[this.name]),this.settings.value===undefined||this.settings.value===null?(this.settings.field.setValueByText.call(this),u=!0):(this.value=this.settings.value,u=!1),this.lastSavedValue=this.value,this.settings.toggle?(this.$toggle=e(this.settings.toggle),this.$toggle.parent().length||this.$element.after(this.$toggle),this.$element.attr("tabindex",-1)):(this.$toggle=this.$element,this.$element.addClass("editable")),this.$toggle.on("click",e.proxy(this.click,this)),e("body").on("click.editable",".editable-popover",function(e){e.stopPropagation()});if(!u&&this.value!==null&&this.value!==undefined)switch(this.settings.autotext){case"always":o=!0;break;case"never":o=!1;break;case"auto":this.$element.html().length?o=!1:i==="select"?(this.settings.field.source=r(this.settings.field.source,!0),this.settings.field.source&&typeof this.settings.field.source=="object"&&(o=!0)):o=!0}o?e.when(this.settings.field.setTextByValue.call(this)).then(e.proxy(a,this)):a.call(this)};t.prototype={constructor:t,click:function(e){e.stopPropagation(),e.preventDefault();var t=this.$element.data("popover");t&&t.tip().is(":visible")?this.hide():this.show()},show:function(){e(".popover").find("form").find("button.editable-cancel").click(),this.$element.data("popover")||(this.$element.popover({trigger:"manual",placement:"top",content:this.settings.loading}),this.$element.data("popover").tip().addClass("editable-popover")),this.$element.popover("show"),this.setPosition(),this.$element.addClass("editable-open"),this.errorOnRender=!1,e.when(this.settings.field.renderInput.call(this)).then(e.proxy(function(){var t=this.$element.data("popover").tip();this.$content=e(this.settings.formTemplate),this.$content.find("div.control-group").prepend(this.$input),t.find(".popover-content p").append(this.$content),this.setPosition(),this.errorOnRender?(this.$input.attr("disabled",!0),t.find("button.btn-primary").attr("disabled",!0),t.find("form").submit(function(){return!1}),this.enableContent(this.errorOnRender)):(this.$input.removeAttr("disabled"),t.find("button.btn-primary").removeAttr("disabled"),t.find("form").submit(e.proxy(this.submit,this)),this.enableContent(),this.settings.field.setInputValue.call(this)),t.find("button.editable-cancel").click(e.proxy(this.hide,this)),e(document).on("keyup.editable",e.proxy(function(e){e.which===27&&(e.stopPropagation(),this.hide())},this)),e(document).on("click.editable",e.proxy(this.hide,this)),this.$element.trigger("shown",this)},this))},submit:function(e){e.stopPropagation(),e.preventDefault();var t,n=this.settings.field.getInputValue.call(this);if(t=this.validate(n)){this.enableContent(t);return}n==this.value?this.hide():this.save(n)},save:function(t){e.when(this.send(t)).done(e.proxy(function(e){var n,r=typeof e!="undefined";if(r&&typeof this.settings.success=="function"&&(n=this.settings.success.apply(this,arguments))){this.enableContent(n);return}this.value=t,this.settings.field.setTextByValue.call(this),r?this.markAsSaved():this.markAsUnsaved(),this.handleEmpty(),this.hide(),this.$element.trigger("update",this);var i=jQuery.Event("render");i.isInit=!1,this.$element.trigger(i,this)},this)).fail(e.proxy(function(e){var t=typeof this.settings.error=="function"?this.settings.error.apply(this,arguments):null;this.enableContent(t||e.responseText||e.statusText)},this))},send:function(t){var n,i,s;typeof this.settings.pk=="function"?i=this.settings.pk.call(this.$element):typeof this.settings.pk=="string"&&e(this.settings.pk).length===1&&e(this.settings.pk).parent().length?i=e(this.settings.pk).text():i=this.settings.pk,n=this.settings.url!==undefined&&(this.settings.send==="always"||this.settings.send==="auto"&&i||this.settings.send==="ifpk"&&i);if(n)return this.enableLoading(),this.settings.params=r(this.settings.params,!0),s=typeof this.settings.params=="string"?{params:this.settings.params}:e.extend({},this.settings.params),s.name=this.name,s.value=t,i&&(s.pk=i),e.ajax({url:typeof this.settings.url=="function"?this.settings.url.call(this):this.settings.url,data:s,type:"post",dataType:"json"})},hide:function(){this.$element.popover("hide"),this.$element.removeClass("editable-open"),e(document).off("keyup.editable"),e(document).off("click.editable"),(this.settings.enablefocus||this.$element.get(0)!==this.$toggle.get(0))&&this.$toggle.focus(),this.$element.trigger("hidden",this)},enableContent:function(e){e!==undefined&&e.length>0?this.$content.find("div.control-group").addClass("error").find("span.help-block").text(e):this.$content.find("div.control-group").removeClass("error").find("span.help-block").text(""),this.$content.show(),this.$element.data("popover").tip().find(".editable-loading").hide(),this.setPosition(),(this.settings.type==="text"||this.settings.type==="textarea")&&this.$input.focus()},setPosition:function(){var e=this.$element.data("popover"),t=e.tip(),n=!1,r,i,s,o,u;r=typeof e.options.placement=="function"?e.options.placement.call(e,t[0],e.$element[0]):e.options.placement,i=e.getPosition(n),s=t[0].offsetWidth,o=t[0].offsetHeight;switch(n?r.split(" ")[1]:r){case"bottom":u={top:i.top+i.height,left:i.left+i.width/2-s/2};break;case"top":t.find(".arrow").get(0).offsetHeight===10&&(o+=10),u={top:i.top-o,left:i.left+i.width/2-s/2};break;case"left":t.find(".arrow").get(0).offsetWidth===10&&(s+=10),u={top:i.top+i.height/2-o/2,left:i.left-s};break;case"right":u={top:i.top+i.height/2-o/2,left:i.left+i.width}}t.css(u).addClass(r).addClass("in")},enableLoading:function(){var e=this.$element.data("popover").$tip;e.find(".editable-loading").css({height:this.$content[0].offsetHeight,width:this.$content[0].offsetWidth}),this.$content.hide(),this.$element.data("popover").tip().find(".editable-loading").show()},handleEmpty:function(){if(!this.$element.hasClass("editable"))return;e.trim(this.$element.text())===""?this.$element.addClass("editable-empty").text(this.settings.emptytext):this.$element.removeClass("editable-empty")},validate:function(e){e===undefined&&(e=this.value);if(typeof this.settings.validate=="function")return this.settings.validate.call(this,e)},markAsUnsaved:function(){this.value!==this.lastSavedValue?this.$element.addClass("editable-changed"):this.$element.removeClass("editable-changed")},markAsSaved:function(){this.lastSavedValue=this.value,this.$element.removeClass("editable-changed")}},e.fn.editable=function(n){var r={},i=arguments;switch(n){case"validate":return this.each(function(){var t=e(this),n=t.data("editable"),i;n&&(i=n.validate())&&(r[n.name]=i)}),r;case"getValue":return this.each(function(){var t=e(this),n=t.data("editable");n&&n.value!==undefined&&n.value!==null&&(r[n.name]=n.value)}),r;case"submit":var s=arguments[1]||{},o=this,u=this.editable("validate"),a;return typeof s.error!="function"&&(s.error=function(){}),e.isEmptyObject(u)?(a=this.editable("getValue"),s.data&&e.extend(a,s.data),e.ajax({type:"POST",url:s.url,data:a,dataType:"json"}).success(function(e){typeof e=="object"&&e.id?(o.editable("option","pk",e.id),o.editable("markAsSaved"),typeof s.success=="function"&&s.success.apply(o,arguments)):s.error.apply(o,arguments)}).error(function(){s.error.apply(o,arguments)})):s.error.call(o,{errors:u}),this}return this.each(function(){var r=e(this),s=r.data("editable"),o=typeof n=="object"&&n;s||r.data("editable",s=new t(this,o)),n==="option"?i.length===2&&typeof i[1]=="object"?e.extend(s.settings,i[1]):i.length===3&&typeof i[1]=="string"&&(s.settings[i[1]]=i[2]):typeof n=="string"&&s[n]()})},e.fn.editable.Constructor=t,e.fn.editable.defaults={url:null,type:"text",name:null,pk:null,value:null,emptytext:"Empty",params:null,send:"auto",autotext:"auto",enablefocus:!1,formTemplate:'<form class="form-inline" autocomplete="off"><div class="control-group">&nbsp;<button type="submit" class="btn btn-primary"><i class="icon-ok icon-white"></i></button>&nbsp;<button type="button" class="btn editable-cancel"><i class="icon-ban-circle"></i></button><span class="help-block" style="clear: both"></span></div></form>',loading:'<div class="editable-loading"></div>',field:null,validate:function(e){},success:function(e){},error:function(e){}},e.fn.editable.types={defaults:{inputclass:"span2",placeholder:null,init:function(e){},renderInput:function(){this.$input=e(this.settings.template),this.$input.addClass(this.settings.inputclass),this.settings.placeholder&&this.$input.attr("placeholder",this.settings.placeholder)},setInputValue:function(){this.$input.val(this.value),this.$input.focus()},getInputValue:function(){return this.$input.val()},setTextByValue:function(){this.$element.text(this.value)},setValueByText:function(){this.value=e.trim(this.$element.text())}},text:{template:'<input type="text">',setInputValue:function(){this.$input.val(this.value),n.call(this.$input,this.$input.val().length),this.$input.focus()}},select:{template:"<select></select>",source:null,prepend:!1,onSourceReady:function(t,n){try{this.settings.source=r(this.settings.source,!1)}catch(i){n.call(this);return}if(typeof this.settings.source=="string"){var s=this.settings.source+"-"+this.name,o;e(document).data(s)||e(document).data(s,{}),o=e(document).data(s);if(o.loading===!1&&o.source&&typeof o.source=="object"){this.settings.source=o.source,t.call(this);return}if(o.loading===!0){o.callbacks.push(e.proxy(function(){this.settings.source=o.source,t.call(this)},this)),o.err_callbacks.push(e.proxy(n,this));return}o.loading=!0,o.callbacks=[],o.err_callbacks=[],e.ajax({url:this.settings.source,type:"get",data:{name:this.name},dataType:"json",success:e.proxy(function(n){this.settings.source=this.settings.doPrepend.call(this,n),o.loading=!1,o.source=this.settings.source,t.call(this),e.each(o.callbacks,function(){this.call()})},this),error:e.proxy(function(){o.loading=!1,n.call(this),e.each(o.err_callbacks,function(){this.call()})},this)})}else{if(e.isArray(this.settings.source)){var u=this.settings.source,a={};for(var f=0;f<u.length;f++)u[f]!==undefined&&(a[f]=u[f]);this.settings.source=a}this.settings.source=this.settings.doPrepend.call(this,this.settings.source),t.call(this)}},doPrepend:function(t){return this.settings.prepend=r(this.settings.prepend,!0),typeof this.settings.prepend=="string"?e.extend({},{"":this.settings.prepend},t):typeof this.settings.prepend=="object"?e.extend({},this.settings.prepend,t):t},renderInput:function(){var t=e.Deferred();return this.$input=e(this.settings.template),this.$input.addClass(this.settings.inputclass),this.settings.onSourceReady.call(this,function(){typeof this.settings.source=="object"&&this.settings.source!=null&&e.each(this.settings.source,e.proxy(function(t,n){this.$input.append(e("<option>",{value:t}).text(n))},this)),t.resolve()},function(){this.errorOnRender="Error when loading options",t.resolve()}),t.promise()},setValueByText:function(){this.value=null},setTextByValue:function(){var t=e.Deferred();return this.settings.onSourceReady.call(this,function(){typeof this.settings.source=="object"&&this.value in this.settings.source?this.$element.text(this.settings.source[this.value]):this.$element.text(""),t.resolve()},function(){this.$element.text("Error!"),t.resolve()}),t.promise()}},textarea:{template:'<textarea rows="8"></textarea>',inputclass:"span3",renderInput:function(){this.$input=e(this.settings.template),this.$input.addClass(this.settings.inputclass),this.settings.placeholder&&this.$input.attr("placeholder",this.settings.placeholder),this.$input.keydown(function(t){t.ctrlKey&&t.which===13&&e(this).closest("form").submit()})},setInputValue:function(){this.$input.val(this.value),n.apply(this.$input,[this.$input.val().length]),this.$input.focus()},setValueByText:function(){var t=this.$element.html().split(/<br\s*\/?>/i);for(var n=0;n<t.length;n++)t[n]=e("<div>").html(t[n]).text();this.value=t.join("\n")},setTextByValue:function(){var t=this.value.split("\n");for(var n=0;n<t.length;n++)t[n]=e("<div>").text(t[n]).html();var r=t.join("<br>");this.$element.html(r)}},date:{template:'<div style="float: left; padding: 0; margin: 0" class="well"></div>',format:"yyyy-mm-dd",viewformat:null,datepicker:{autoclose:!1,keyboardNavigation:!1},init:function(t){var n=i({},this.settings,["format","weekStart","startView"]);this.settings.datepicker=e.extend({},e.fn.editable.types.date.datepicker,n,t.datepicker),this.settings.viewformat||(this.settings.viewformat=this.settings.datepicker.format)},renderInput:function(){this.$input=e(this.settings.template),this.$input.datepicker(this.settings.datepicker)},setInputValue:function(){this.$input.datepicker("update",this.value)},getInputValue:function(){var e=this.$input.data("datepicker");return e.getFormattedDate()},setTextByValue:function(){var e=this.settings.converFormat.call(this,this.value,this.settings.format,this.settings.viewformat);this.$element.text(e)},setValueByText:function(){var t=e.trim(this.$element.text());if(!t.length)return;this.value=this.settings.converFormat.call(this,t,this.settings.viewformat,this.settings.format)},converFormat:function(t,n,r){if(n===r)return t;var i=e.fn.datepicker.DPGlobal,s,o=this.settings.datepicker&&this.settings.datepicker.language||"en";return n=i.parseFormat(n),r=i.parseFormat(r),s=i.parseDate(e.trim(t),n,o),i.formatDate(s,r,o)}}},function(e){e.fn.editable.models={fieldType:{inputclass:"span2",placeholder:null,template:'<input type="text">',source:null,format:!1,viewFormat:!1,widgetOptions:{},init:function(e){},setup:function(e){this.settings.hasOwnProperty("source")&&(this.settings.field.source=this.settings.source)},renderInput:function(){},setInputValue:function(){},getInputValue:function(){},setTextByValue:function(){},setValueByText:function(){}}},e.fn.editable.fieldTypes={},function(){var t=e.fn.editable.fieldTypes,s=e.extend(!0,{},e.fn.editable.models.fieldType,{renderInput:function(){this.$input=e(this.settings.field.template),this.$input.addClass(this.settings.field.inputclass),this.settings.field.placeholder&&this.$input.attr("placeholder",this.settings.field.placeholder)},setInputValue:function(){this.$input.val(this.value),this.$input.focus()},getInputValue:function(){return this.$input.val()},setTextByValue:function(){this.$element.text(this.value)},setValueByText:function(){this.value=e.trim(this.$element.text())}});t.text=e.extend(!0,{},s,{template:'<input type="text">',setInputValue:function(){this.$input.val(this.value),n.call(this.$input,this.$input.val().length),this.$input.focus()}}),t.select=e.extend(!0,{},s,{template:"<select></select>",source:null,prepend:!1,onSourceReady:function(t,n){try{this.settings.field.source=r(this.settings.field.source,!1)}catch(i){n.call(this);return}if(typeof this.settings.field.source=="string"){var s=this.settings.field.source+"-"+this.name,o;e(document).data(s)||e(document).data(s,{}),o=e(document).data(s);if(o.loading===!1&&o.source&&typeof o.source=="object"){this.settings.field.source=o.source,t.call(this);return}if(o.loading===!0){o.callbacks.push(e.proxy(function(){this.settings.field.source=o.source,t.call(this)},this)),o.err_callbacks.push(e.proxy(n,this));return}o.loading=!0,o.callbacks=[],o.err_callbacks=[],e.ajax({url:this.settings.field.source,type:"get",data:{name:this.name},dataType:"json",success:e.proxy(function(n){this.settings.field.source=this.settings.field.doPrepend.call(this,n),o.loading=!1,o.source=this.settings.field.source,t.call(this),e.each(o.callbacks,function(){this.call()})},this),error:e.proxy(function(){o.loading=!1,n.call(this),e.each(o.err_callbacks,function(){this.call()})},this)})}else{if(e.isArray(this.settings.field.source)){var u=this.settings.field.source,a={};for(var f=0;f<u.length;f++)u[f]!==undefined&&(a[f]=u[f]);this.settings.field.source=a}this.settings.field.source=this.settings.field.doPrepend.call(this,this.settings.field.source),t.call(this)}},doPrepend:function(t){return this.settings.field.prepend=r(this.settings.field.prepend,!0),typeof this.settings.field.prepend=="string"?e.extend({},{"":this.settings.field.prepend},t):typeof this.settings.field.prepend=="object"?e.extend({},this.settings.field.prepend,t):t},renderInput:function(){var t=e.Deferred();return this.$input=e(this.settings.field.template),this.$input.addClass(this.settings.field.inputclass),this.settings.field.onSourceReady.call(this,function(){typeof this.settings.field.source=="object"&&this.settings.field.source!=null&&e.each(this.settings.field.source,e.proxy(function(t,n){this.$input.append(e("<option>",{value:t}).text(n))},this)),t.resolve()},function(){this.errorOnRender="Error when loading options",t.resolve()}),t.promise()},setValueByText:function(){this.value=null},setTextByValue:function(){var t=e.Deferred();return this.settings.field.onSourceReady.call(this,function(){typeof this.settings.field.source=="object"&&this.value in this.settings.field.source?this.$element.text(this.settings.field.source[this.value]):this.$element.text(""),t.resolve()},function(){this.$element.text("Error!"),t.resolve()}),t.promise()},init:function(e){this.settings.hasOwnProperty("source")&&this.settings.source!=null&&(this.settings.field.source=this.settings.source)}}),t.textarea=e.extend(!0,{},s,{template:'<textarea rows="8"></textarea>',inputclass:"span3",renderInput:function(){this.$input=e(this.settings.field.template),this.$input.addClass(this.settings.field.inputclass),this.settings.field.placeholder&&this.$input.attr("placeholder",this.settings.field.placeholder),this.$input.keydown(function(t){t.ctrlKey&&t.which===13&&e(this).closest("form").submit()})},setInputValue:function(){this.$input.val(this.value),n.apply(this.$input,[this.$input.val().length]),this.$input.focus()},setValueByText:function(){var t=this.$element.html().split(/<br\s*\/?>/i);for(var n=0;n<t.length;n++)t[n]=e("<div>").html(t[n]).text();this.value=t.join("\n")},setTextByValue:function(){var t=this.value.split("\n");for(var n=0;n<t.length;n++)t[n]=e("<div>").text(t[n]).html();var r=t.join("<br>");this.$element.html(r)}}),t.date=e.extend(!0,{},s,{template:'<div style="float: left; padding: 0; margin: 0" class="well"></div>',format:"yyyy-mm-dd",viewformat:null,datepicker:{autoclose:!1,keyboardNavigation:!1},init:function(t){var n=i({},this.settings,["format","weekStart","startView"]);this.settings.field.datepicker=e.extend({},e.fn.editable.types.date.datepicker,n,t.datepicker),this.settings.field.viewformat||(this.settings.field.viewformat=this.settings.field.datepicker.format)},renderInput:function(){this.$input=e(this.settings.field.template),this.$input.datepicker(this.settings.field.datepicker)},setInputValue:function(){this.$input.datepicker("update",this.value)},getInputValue:function(){var e=this.$input.data("datepicker");return e.getFormattedDate()},setTextByValue:function(){var e=this.settings.field.converFormat.call(this,this.value,this.settings.field.format,this.settings.field.viewformat);this.$element.text(e)},setValueByText:function(){var t=e.trim(this.$element.text());if(!t.length)return;this.value=this.settings.field.converFormat.call(this,t,this.settings.field.viewformat,this.settings.field.format)},converFormat:function(t,n,r){if(n===r)return t;var i=e.fn.datepicker.DPGlobal,s,o=this.settings.field.datepicker&&this.settings.field.datepicker.language||"en";return n=i.parseFormat(n),r=i.parseFormat(r),s=i.parseDate(e.trim(t),n,o),i.formatDate(s,r,o)}})}()}(jQuery)})(window.jQuery),!function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}var n=function(t,n){var s=this;this.element=e(t),this.language=n.language||this.element.data("date-language")||"en",this.language=this.language in r?this.language:"en",this.format=i.parseFormat(n.format||this.element.data("date-format")||"mm/dd/yyyy"),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}):this.component&&this.hasInput?(this.element.find("input").on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}),this.component.on("click",e.proxy(this.show,this))):this.element.is("div")?this.isInline=!0:this.element.on("click",e.proxy(this.show,this)),this.picker=e(i.template).appendTo(this.isInline?this.element:"body").on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.isInline?this.picker.addClass("datepicker-inline"):this.picker.addClass("dropdown-menu"),e(document).on("mousedown",function(t){e(t.target).closest(".datepicker").length==0&&s.hide()}),this.autoclose=!1,"autoclose"in n?this.autoclose=n.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in n?this.keyboardNavigation=n.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation"));switch(n.startView||this.element.data("date-start-view")){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break;case 0:case"month":default:this.viewMode=this.startViewMode=0}this.weekStart=(n.weekStart||this.element.data("date-weekstart")||r[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-Infinity,this.endDate=Infinity,this.setStartDate(n.startDate||this.element.data("date-startdate")),this.setEndDate(n.endDate||this.element.data("date-enddate")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};n.prototype={constructor:n,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.element.trigger({type:"show",date:this.date})},hide:function(t){if(this.isInline)return;this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),t&&t.currentTarget.value&&this.setValue(),this.element.trigger({type:"hide",date:this.date})},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.prop("value",e):(this.component&&this.element.find("input").prop("value",e),this.element.data("date",e))},getFormattedDate:function(e){return e==undefined&&(e=this.format),i.formatDate(this.date,e,this.language)},setStartDate:function(e){this.startDate=e||-Infinity,this.startDate!==-Infinity&&(this.startDate=i.parseDate(this.startDate,this.format,this.language)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||Infinity,this.endDate!==Infinity&&(this.endDate=i.parseDate(this.endDate,this.format,this.language)),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return;var t=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10,n=this.component?this.component.offset():this.element.offset();this.picker.css({top:n.top+this.height,left:n.left,zIndex:t})},update:function(){var e,t=!1;arguments&&arguments.length&&(typeof arguments[0]=="string"||arguments[0]instanceof Date)?(e=arguments[0],t=!0):e=this.isInput?this.element.prop("value"):this.element.data("date")||this.element.find("input").prop("value"),this.date=i.parseDate(e,this.format,this.language),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){var e=this.weekStart,t="<tr>";while(e<this.weekStart+7)t+='<th class="dow">'+r[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="month">'+r[this.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},fill:function(){var e=new Date(this.viewDate),n=e.getUTCFullYear(),s=e.getUTCMonth(),o=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,u=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,a=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,f=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,l=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(r[this.language].months[s]+" "+n),this.updateNavArrows(),this.fillMonths();var c=t(n,s-1,28,0,0,0,0),h=i.getDaysInMonth(c.getUTCFullYear(),c.getUTCMonth());c.setUTCDate(h),c.setUTCDate(h-(c.getUTCDay()-this.weekStart+7)%7);var p=new Date(c);p.setUTCDate(p.getUTCDate()+42),p=p.valueOf();var d=[],v;while(c.valueOf()<p){c.getUTCDay()==this.weekStart&&d.push("<tr>"),v="";if(c.getUTCFullYear()<n||c.getUTCFullYear()==n&&c.getUTCMonth()<s)v+=" old";else if(c.getUTCFullYear()>n||c.getUTCFullYear()==n&&c.getUTCMonth()>s)v+=" new";c.valueOf()==l&&(v+=" active");if(c.valueOf()<this.startDate||c.valueOf()>this.endDate)v+=" disabled";d.push('<td class="day'+v+'">'+c.getUTCDate()+"</td>"),c.getUTCDay()==this.weekEnd&&d.push("</tr>"),c.setUTCDate(c.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(d.join(""));var m=this.date.getUTCFullYear(),g=this.picker.find(".datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("active");m==n&&g.eq(this.date.getUTCMonth()).addClass("active"),(n<o||n>a)&&g.addClass("disabled"),n==o&&g.slice(0,u).addClass("disabled"),n==a&&g.slice(f+1).addClass("disabled"),d="",n=parseInt(n/10,10)*10;var y=this.picker.find(".datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;for(var b=-1;b<11;b++)d+='<span class="year'+(b==-1||b==10?" old":"")+(m==n?" active":"")+(n<o||n>a?" disabled":"")+'">'+n+"</span>",n+=1;y.html(d)},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()&&n<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()&&n>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.startDate!==-Infinity&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==Infinity&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},click:function(n){n.stopPropagation(),n.preventDefault();var r=e(n.target).closest("span, td, th");if(r.length==1)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var s=i.modes[this.viewMode].navStep*(r[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s)}this.fill()}break;case"span":if(!r.is(".disabled")){this.viewDate.setUTCDate(1);if(r.is(".month")){var o=r.parent().find("span").index(r);this.viewDate.setUTCMonth(o),this.element.trigger({type:"changeMonth",date:this.viewDate})}else{var u=parseInt(r.text(),10)||0;this.viewDate.setUTCFullYear(u),this.element.trigger({type:"changeYear",date:this.viewDate})}this.showMode(-1),this.fill()}break;case"td":if(r.is(".day")&&!r.is(".disabled")){var a=parseInt(r.text(),10)||1,u=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth();r.is(".old")?o==0?(o=11,u-=1):o-=1:r.is(".new")&&(o==11?(o=0,u+=1):o+=1),this.date=t(u,o,a,0,0,0,0),this.viewDate=t(u,o,a,0,0,0,0),this.fill(),this.setValue(),this.element.trigger({type:"changeDate",date:this.date});var f;this.isInput?f=this.element:this.component&&(f=this.element.find("input")),f&&(f.change(),this.autoclose&&this.hide())}}},moveMonth:function(e,t){if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o},o=i+t,n.setUTCMonth(o);if(o<0||o>11)o=(o+12)%12}else{for(var a=0;a<s;a++)n=this.moveMonth(n,t);o=n.getUTCMonth(),n.setUTCDate(r),u=function(){return o!=n.getUTCMonth()}}while(u())n.setUTCDate(--r),n.setUTCMonth(o);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){e.keyCode==27&&this.show();return}var t=!1,n,r,i,s,o;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;n=e.keyCode==37?-1:1,e.ctrlKey?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):e.shiftKey?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):(s=new Date(this.date),s.setUTCDate(this.date.getUTCDate()+n),o=new Date(this.viewDate),o.setUTCDate(this.viewDate.getUTCDate()+n)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;n=e.keyCode==38?-1:1,e.ctrlKey?(s=this.moveYear(this.date,n),o=this.moveYear(this.viewDate,n)):e.shiftKey?(s=this.moveMonth(this.date,n),o=this.moveMonth(this.viewDate,n)):(s=new Date(this.date),s.setUTCDate(this.date.getUTCDate()+n*7),o=new Date(this.viewDate),o.setUTCDate(this.viewDate.getUTCDate()+n*7)),this.dateWithinRange(s)&&(this.date=s,this.viewDate=o,this.setValue(),this.update(),e.preventDefault(),t=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(t){this.element.trigger({type:"changeDate",date:this.date});var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(0,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+i.modes[this.viewMode].clsName).show(),this.updateNavArrows()}},e.fn.datepicker=function(t){var r=Array.apply(null,arguments);return r.shift(),this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof t=="object"&&t;s||i.data("datepicker",s=new n(this,e.extend({},e.fn.datepicker.defaults,o))),typeof t=="string"&&typeof s[t]=="function"&&s[t].apply(s,r)})},e.fn.datepicker.defaults={},e.fn.datepicker.Constructor=n;var r=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},i={modes:[{clsName:"days",navFnc:"Month",navStep
:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,i.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length==0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(i,s,o){if(i instanceof Date)return i;if(/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(i)){var u=/([-+]\d+)([dmwy])/,a=i.match(/([-+]\d+)([dmwy])/g),f,l;i=new Date;for(var c=0;c<a.length;c++){f=u.exec(a[c]),l=parseInt(f[1]);switch(f[2]){case"d":i.setUTCDate(i.getUTCDate()+l);break;case"m":i=n.prototype.moveMonth.call(n.prototype,i,l);break;case"w":i.setUTCDate(i.getUTCDate()+l*7);break;case"y":i=n.prototype.moveYear.call(n.prototype,i,l)}}return t(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0,0,0)}var a=i&&i.match(this.nonpunctuation)||[],i=new Date,h={},p=["yyyy","yy","M","MM","m","mm","d","dd"],d={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!=t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},v,m,f;d.M=d.MM=d.mm=d.m,d.dd=d.d,i=t(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0,0,0);if(a.length==s.parts.length){for(var c=0,g=s.parts.length;c<g;c++){v=parseInt(a[c],10),f=s.parts[c];if(isNaN(v))switch(f){case"MM":m=e(r[o].months).filter(function(){var e=this.slice(0,a[c].length),t=a[c].slice(0,e.length);return e==t}),v=e.inArray(m[0],r[o].months)+1;break;case"M":m=e(r[o].monthsShort).filter(function(){var e=this.slice(0,a[c].length),t=a[c].slice(0,e.length);return e==t}),v=e.inArray(m[0],r[o].monthsShort)+1}h[f]=v}for(var c=0,y;c<p.length;c++)y=p[c],y in h&&d[y](i,h[y])}return i},formatDate:function(t,n,i){var s={d:t.getUTCDate(),m:t.getUTCMonth()+1,M:r[i].monthsShort[t.getUTCMonth()],MM:r[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m;var t=[],o=e.extend([],n.separators);for(var u=0,a=n.parts.length;u<a;u++)o.length&&t.push(o.shift()),t.push(s[n.parts[u]]);return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};i.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+i.headTemplate+"<tbody></tbody>"+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+i.headTemplate+i.contTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+i.headTemplate+i.contTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=i}(window.jQuery);